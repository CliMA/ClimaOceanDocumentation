<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Generate bathymetry · ClimaOcean.jl</title><meta name="title" content="Generate bathymetry · ClimaOcean.jl"/><meta property="og:title" content="Generate bathymetry · ClimaOcean.jl"/><meta property="twitter:title" content="Generate bathymetry · ClimaOcean.jl"/><meta name="description" content="Documentation for ClimaOcean.jl."/><meta property="og:description" content="Documentation for ClimaOcean.jl."/><meta property="twitter:description" content="Documentation for ClimaOcean.jl."/><meta property="og:url" content="https://clima.github.io/ClimaOceanDocumentation/dev/literated/generate_bathymetry/"/><meta property="twitter:url" content="https://clima.github.io/ClimaOceanDocumentation/dev/literated/generate_bathymetry/"/><link rel="canonical" href="https://clima.github.io/ClimaOceanDocumentation/dev/literated/generate_bathymetry/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ClimaOcean.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../inspect_ecco_data/">Inspect ECCO2 data</a></li><li class="is-active"><a class="tocitem" href>Generate bathymetry</a></li><li><a class="tocitem" href="../generate_surface_fluxes/">Surface fluxes</a></li><li><a class="tocitem" href="../single_column_os_papa_simulation/">Single-column simulation</a></li><li><a class="tocitem" href="../near_global_ocean_simulation/">Near-global Ocean simulation</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../library/outline/">Contents</a></li><li><a class="tocitem" href="../../library/public/">Public</a></li><li><a class="tocitem" href="../../library/internals/">Private</a></li><li><a class="tocitem" href="../../library/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Generate bathymetry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Generate bathymetry</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaOcean.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaOcean.jl/blob/main/examples/generate_bathymetry.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Generate-bathymetry-data-for-the-Mediterranean-Sea"><a class="docs-heading-anchor" href="#Generate-bathymetry-data-for-the-Mediterranean-Sea">Generate bathymetry data for the Mediterranean Sea</a><a id="Generate-bathymetry-data-for-the-Mediterranean-Sea-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-bathymetry-data-for-the-Mediterranean-Sea" title="Permalink"></a></h1><p>This example shows how to configure an Immersed boundary grid with realistic bathymetry using ClimaOcean.jl by generating the bathymetry data for the Mediterranean Sea.</p><p>For this example, we need Oceananigans for the LatitudeLongitudeGrid and Field utilities, ClimaOcean to donwload and regrid the bathymetry, and CairoMakie to visualize the grid.</p><pre><code class="language-julia hljs">using ClimaOcean
using Oceananigans
using CairoMakie</code></pre><p>We start by defining a gridded domain for the Mediterranean Sea using the <code>LatitudeLongitudeGrid</code> from Oceananigans.</p><p>The Mediterranean sea is positioned roughly between 28ᵒ and 48ᵒ latitude and 0ᵒ and 42ᵒ longitude. We define a grid in this region and to have a reasonable resolution, we set a grid resolution to 1/25ᵒ in both latitude and longitude directions.</p><pre><code class="language-julia hljs">latitude_range = (28, 48)
longitude_range = (0, 42)

Nφ = 25 * (latitude_range[2] - latitude_range[1])
Nλ = 25 * (longitude_range[2] - longitude_range[1])

grid = LatitudeLongitudeGrid(size = (Nλ, Nφ, 1),
                             latitude = latitude_range,
                             longitude = longitude_range,
                             z = (0, 1),
                             halo = (7, 7, 1))</code></pre><pre><code class="nohighlight hljs">1050×500×1 LatitudeLongitudeGrid{Float64, Oceananigans.Grids.Bounded, Oceananigans.Grids.Bounded, Oceananigans.Grids.Bounded} on Oceananigans.Architectures.CPU with 7×7×1 halo and with precomputed metrics
├── longitude: Bounded  λ ∈ [0.0, 42.0]  regularly spaced with Δλ=0.04
├── latitude:  Bounded  φ ∈ [28.0, 48.0] regularly spaced with Δφ=0.04
└── z:         Bounded  z ∈ [0.0, 1.0]   regularly spaced with Δz=1.0</code></pre><p>Next, we generate the bathymetry data for the Mediterranean Sea using the <code>regrid_bathymetry</code> function from ClimaOcean. The function downloads the bathymetry data from the ETOPO1 dataset, regrids it to the provided grid, and returns the bathymetry field. The three different regidding procedures below demonstrate the effect of different parameters on the generated bathymetry:</p><ul><li><code>h_rough</code> shows the output of the function with default parameters, which means only one interpolation passes and no restrictions on connected regions.</li><li><code>h_smooth</code> shows the output of the function with 40 interpolation passes, which results  in a smoother bathymetry.</li><li><code>h_no_connected_regions</code> shows the output of the function with <code>major_basins = 1</code>, which  means that the function does not allow connected regions in the bathymetry  (e.g., lakes)  and fills them with land.</li></ul><pre><code class="language-julia hljs">h_rough = regrid_bathymetry(grid)
h_smooth = regrid_bathymetry(grid; interpolation_passes = 40)
h_one_basin = regrid_bathymetry(grid; major_basins = 1)</code></pre><p>Finally, we visualize the generated bathymetry data for the Mediterranean Sea using CairoMakie.</p><pre><code class="language-julia hljs">land_smooth = interior(h_smooth) .&gt;= 0
interior(h_smooth)[land_smooth] .= NaN

land_rough = interior(h_rough) .&gt;= 0
interior(h_rough)[land_rough] .= NaN

land_one_basin = interior(h_one_basin) .&gt;= 0
interior(h_one_basin)[land_one_basin] .= NaN

fig = Figure(size=(850, 1150))

ax = Axis(fig[1, 1], title = &quot;Rough bathymetry&quot;, xlabel = &quot;Longitude&quot;, ylabel = &quot;Latitude&quot;)
hm = heatmap!(ax, h_rough, nan_color=:lightgray, colormap = Reverse(:deep))

ax = Axis(fig[2, 1], title = &quot;Smooth bathymetry&quot;, xlabel = &quot;Longitude&quot;, ylabel = &quot;Latitude&quot;)
hm = heatmap!(ax, h_smooth, nan_color=:lightgray, colormap = Reverse(:deep))

ax = Axis(fig[3, 1], title = &quot;Bathymetry with only one basin&quot;, xlabel = &quot;Longitude&quot;, ylabel = &quot;Latitude&quot;)
hm = heatmap!(ax, h_one_basin, nan_color=:lightgray, colormap = Reverse(:deep))

cb = Colorbar(fig[1:3, 2], hm, height = Relative(3/4), label = &quot;Depth (m)&quot;)

save(&quot;different_bottom_heights.png&quot;, fig)</code></pre><p><img src="../different_bottom_heights.png" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inspect_ecco_data/">« Inspect ECCO2 data</a><a class="docs-footer-nextpage" href="../generate_surface_fluxes/">Surface fluxes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 15 December 2024 05:48">Sunday 15 December 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
